<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="icon-192.png">

  <title>Fraukes Adventskalender 2025</title>

  <script src="lang/de.js"></script>
  <script src="lang/en.js"></script>
  <script src="lang/no.js"></script>
<script defer data-domain="verabing.github.io"
        src="https://plausible.io/js/script.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght=700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      color: white;
      font-family: 'Cinzel Decorative', serif;
      background: url('bilder/hintergrund5.jpg') center/cover fixed no-repeat;
    }

    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: rgba(0,0,0,0.65);
      padding: 15px 10px 10px;
      text-align: center;
      backdrop-filter: blur(6px);
      z-index: 20;
    }

    header h1 {
      margin: 0 0 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      gap: 8px;
    }

    .header-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: center;
      align-items: center;
      font-family: 'EB Garamond', serif;
    }

    .flag-icon {
      width: 28px;
      height: 20px;
      object-fit: cover;
      border-radius: 3px;
      border: 1px solid #999;
    }

    #langSelect button {
      background: none;
      border: none;
      cursor: pointer;
      margin: 0 4px;
      padding: 3px;
    }

    main {
      padding-top: 160px;
      display: flex;
      justify-content: center;
    }

    #calendar {
      width: 100%;
      max-width: 750px;
      margin: 0 auto 40px;
      column-count: 4;
      column-gap: 16px;
    }

    @media (min-width: 1400px) {
      #calendar { column-count: 5; }
    }
    @media (max-width: 900px) {
      #calendar { column-count: 3; }
    }
    @media (max-width: 600px) {
      #calendar { column-count: 2; padding: 0 16px; }
    }

    .dayCard {
      break-inside: avoid;
      background: #7a0000;
      border-radius: 12px;
      margin-bottom: 16px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.35), 0 1px 3px rgba(0,0,0,0.5);
    }

    .dayCard:hover {
      transform: scale(1.02);
      box-shadow: 0 10px 22px rgba(0,0,0,0.45);
    }

    .dayNumber {
      padding: 40px 0;
      font-size: 2.2rem;
      text-align: center;
      font-weight: bold;
    }

    .dayThumb {
      width: 100%;
      height: auto;
      object-fit: contain;
      display: block;
      border-radius: 10px;
    }

    #modal.hidden { display: none; }

    #modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 50;
    }

    #modalNotYet {
  max-width: 80vw;
  max-height: 50vh;
  object-fit: contain;
  display: block;
  margin: 0 auto;
}

    #modalContent {
      background: rgba(0,0,0,0.75);
      backdrop-filter: blur(8px);
      padding: 20px;
      border-radius: 16px;
      max-width: 650px;
      width: 100%;
      position: relative;
    }

    #modalClose {
      position: absolute;
      top: 8px;
      right: 12px;
      font-size: 26px;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
    }

    #modalTitle,
    #modalText {
      text-align: center;
      font-family: 'EB Garamond', serif;
    }

    #modalText {
      font-size: 1.3rem;
      line-height: 1.5;
    }

    #modalImageWrapper {
      position: relative;
      margin-top: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #modalImage {
      max-width: 90vw;
      max-height: 80vh;
      object-fit: contain;
      border-radius: 10px;
    }

    .navBtn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.4);
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
    }

    #prevImage { left: 8px; }
    #nextImage { right: 8px; }
  </style>
</head>

<body>

<header>
  <h1>Fraukes Adventskalender 2025</h1>

  <div id="langSelect">
    <button data-lang="de"><img src="flags/de.png" class="flag-icon" alt="DE"></button>
    <button data-lang="en"><img src="flags/gb.png" class="flag-icon" alt="EN"></button>
    <button data-lang="no"><img src="flags/no.png" class="flag-icon" alt="NO"></button>
  </div>
</header>

<main>
  <div id="calendar"></div>
</main>

<!-- KORREKTES MODAL -->
<div id="modal" class="hidden">
  <div id="modalContent">
    <button id="modalClose">✕</button>

    <h2 id="modalTitle"></h2>
    <p id="modalText"></p>

    <div id="modalImageWrapper">
      <button id="prevImage" class="navBtn">◀</button>
      <img id="modalImage" src="" alt="">
      <button id="nextImage" class="navBtn">▶</button>
    </div>

  </div>
</div>


<script>
/* ======================
   SPRACHFUNKTIONEN
====================== */

let currentLang = localStorage.getItem("calendar_lang") || "de";

function getLangData() {
  return currentLang === "de" ? lang_de :
         currentLang === "en" ? lang_en :
         lang_no;
}

function setLanguage(lang) {
  currentLang = lang;
  localStorage.setItem("calendar_lang", lang);
  document.querySelector("header h1").textContent = getLangData().headerTitle;
}

document.querySelectorAll("#langSelect button").forEach(btn =>
  btn.addEventListener("click", () => setLanguage(btn.dataset.lang))
);

setLanguage(currentLang);

/* ======================
   BILDER-KONFIG
====================== */

const daysConfig = [
  { day: 1, images: ["bilder/tuer1.jpg","bilder/tuer1b.jpg","bilder/tuer1c.jpg","bilder/tuer1d.jpg"] },
  { day: 2, images: ["bilder/tuer2.jpg","bilder/tuer2b.jpg","bilder/tuer2c.jpg"] },
  { day: 3, images: ["bilder/tuer3.jpg","bilder/tuer3b.jpg","bilder/tuer3c.jpg"] },
  { day: 4, images: ["bilder/tuer4.jpg","bilder/tuer4b.jpg","bilder/tuer4c.jpg"] },
  { day: 5, images: ["bilder/tuer5.jpg","bilder/tuer5b.jpg","bilder/tuer5c.jpg"] },
  { day: 6, images: ["bilder/tuer6.jpg","bilder/tuer6b.jpg","bilder/tuer6c.jpg"] },
  { day: 7, images: ["bilder/tuer7.jpg","bilder/tuer7b.jpg","bilder/tuer7c.jpg"] },
  { day: 8, images: ["bilder/tuer8.jpg","bilder/tuer8b.jpg","bilder/tuer8c.jpg"] },
  { day: 9, images: ["bilder/tuer9.jpg","bilder/tuer9b.jpg","bilder/tuer9c.jpg"] },
  { day: 10, images: ["bilder/tuer10.jpg","bilder/tuer10b.jpg","bilder/tuer10c.jpg"] },
  { day: 11, images: ["bilder/tuer11.jpg","bilder/tuer11b.jpg","bilder/tuer11c.jpg","bilder/tuer11d.jpg","bilder/tuer11e.jpg"] },
  { day: 12, images: ["bilder/tuer12.jpg","bilder/tuer12b.jpg","bilder/tuer12c.jpg"] },
  { day: 13, images: ["bilder/tuer13.jpg","bilder/tuer13b.jpg","bilder/tuer13c.jpg"] },
  { day: 14, images: ["bilder/tuer14.jpg","bilder/tuer14b.jpg","bilder/tuer14c.jpg","bilder/tuer14d.jpg"] },
  { day: 15, images: ["bilder/tuer15.jpg","bilder/tuer15b.jpg","bilder/tuer15c.jpg","bilder/tuer15d.jpg","bilder/tuer15e.jpg"] },
  { day: 16, images: ["bilder/tuer16.jpg","bilder/tuer16b.jpg","bilder/tuer16c.jpg"] },
  { day: 17, images: ["bilder/tuer17.jpg","bilder/tuer17b.jpg","bilder/tuer17c.jpg"] },
  { day: 18, images: ["bilder/tuer18.jpg","bilder/tuer18b.jpg","bilder/tuer18c.jpg"] },
  { day: 19, images: ["bilder/tuer19.jpg","bilder/tuer19b.jpg","bilder/tuer19c.jpg"] },
  { day: 20, images: ["bilder/tuer20.jpg","bilder/tuer20b.jpg","bilder/tuer20c.jpg"] },
  { day: 21, images: ["bilder/tuer21.jpg","bilder/tuer21b.jpg","bilder/tuer21c.jpg"] },
  { day: 22, images: ["bilder/tuer22.jpg","bilder/tuer22b.jpg","bilder/tuer22c.jpg"] },
  { day: 23, images: ["bilder/tuer23.jpg","bilder/tuer23b.jpg","bilder/tuer23c.jpg"] },
  { day: 24, images: ["bilder/tuer24.jpg","bilder/tuer24b.jpg","bilder/tuer24c.jpg"] }
];

/* ======================
   SHUFFLE + GRID
====================== */

const shuffled = [5,12,1,19,7,24,3,16,9,22,14,2,18,11,6,21,4,17,8,23,10,13,15,20];
const STORAGE_PREFIX = "advent2025_";

function isOpened(d) { return localStorage.getItem(STORAGE_PREFIX + d) === "1"; }
function markOpened(d) { localStorage.setItem(STORAGE_PREFIX + d, "1"); }

const calendar = document.getElementById("calendar");

function today() {
  return new Date();
}


shuffled.forEach(dayNum => {
  const cfg = daysConfig.find(d => d.day === dayNum);
  const card = document.createElement("div");
  card.className = "dayCard";
  card.dataset.day = dayNum;

  if (isOpened(dayNum)) {
    const img = document.createElement("img");
    img.className = "dayThumb";
    img.src = cfg.images[0];
    card.appendChild(img);
  } else {
    const num = document.createElement("div");
    num.className = "dayNumber";
    num.textContent = dayNum;
    card.appendChild(num);
  }

  card.addEventListener("click", () => openDoor(dayNum, card));
  calendar.appendChild(card);
});

/* ======================
   MODAL
====================== */

const modal = document.getElementById("modal");
const modalTitle = document.getElementById("modalTitle");
const modalText = document.getElementById("modalText");
const modalImage = document.getElementById("modalImage");

let currentDay = null;
let currentIndex = 0;

function canOpen(day) {
  const d = today();
  const lock = new Date(d.getFullYear(), 11, day);
  return d >= lock;
}

function openDoor(day, card) {
  const cfg = daysConfig.find(d => d.day === day);

  if (!canOpen(day)) {
    modalTitle.innerHTML = `<img id="modalNotYet" src="bilder/notyet.gif" alt="Not Yet!">`;
    modalText.innerHTML = "";
    modalImage.src = "";
    modal.classList.remove("hidden");
    return;
  }

  currentDay = day;
  currentIndex = 0;

  const L = getLangData();
  const dayData = L.days[day];

  modalTitle.innerHTML = dayData.title;
  modalText.innerHTML = Array.isArray(dayData.text) ? dayData.text[0] : dayData.text;

  modalImage.src = cfg.images[0];
  modal.classList.remove("hidden");

  markOpened(day);

  card.innerHTML = "";
  const img = document.createElement("img");
  img.className = "dayThumb";
  img.src = cfg.images[0];
  card.appendChild(img);
}

document.getElementById("modalClose").addEventListener("click", () => modal.classList.add("hidden"));
modal.addEventListener("click", e => { if (e.target === modal) modal.classList.add("hidden"); });

document.getElementById("nextImage").onclick = () => slide(+1);
document.getElementById("prevImage").onclick = () => slide(-1);

function slide(dir) {
  const cfg = daysConfig.find(d => d.day === currentDay);
  currentIndex = (currentIndex + dir + cfg.images.length) % cfg.images.length;
  modalImage.src = cfg.images[currentIndex];

  const L = getLangData();
  const dayData = L.days[currentDay];
  modalText.innerHTML = Array.isArray(dayData.text)
    ? dayData.text[currentIndex] || ""
    : dayData.text;
}



/* ======================
   SWIPE NAVIGATION
====================== */
let touchStartX = 0;
let touchEndX = 0;

modalImage.addEventListener("touchstart", e => touchStartX = e.changedTouches[0].screenX);
modalImage.addEventListener("touchend", e => {
  touchEndX = e.changedTouches[0].screenX;
  const diff = touchEndX - touchStartX;
  if (Math.abs(diff) < 40) return;
  slide(diff > 0 ? -1 : +1);
});

/* ======================
   KEYBOARD NAVIGATION
====================== */
document.addEventListener("keydown", e => {
  if (modal.classList.contains("hidden")) return;

  if (e.key === "ArrowRight") slide(+1);
  else if (e.key === "ArrowLeft") slide(-1);
  else if (e.key === "Escape") modal.classList.add("hidden");
});
</script>

</body>
</html>
